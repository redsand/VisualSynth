from pathlib import Path
text = Path('src/renderer/index.ts').read_text()
start = text.index('const renderAssets = () => {')
end = text.index('const importAsset', start)
new_block = """const renderAssets = () => {\n  assetList.innerHTML = '';\n  if (currentProject.assets.length === 0) {\n    const empty = document.createElement('div');\n    empty.className = 'matrix-empty';\n    empty.textContent = 'No assets yet.';\n    assetList.appendChild(empty);\n    return;\n  }\n\n  currentProject.assets.forEach((asset) => {\n    const row = document.createElement('div');\n    row.className = 'asset-row';\n\n    const preview = document.createElement('div');\n    preview.className = 'asset-preview';\n    if (asset.thumbnail) {\n      preview.style.backgroundImage = `url(${asset.thumbnail})`;\n    }\n\n    const info = document.createElement('div');\n    info.className = 'asset-info';\n    const title = document.createElement('span');\n    title.textContent = asset.name;\n    const details = document.createElement('span');\n    details.textContent = `${asset.kind} · ${asset.width ?? '--'}x${asset.height ?? '--'} · ${formatBytes(\n      asset.mime ? 1 : undefined\n    )}`;\n    if (asset.missing) details.textContent += ' · Missing file';\n    info.appendChild(title);\n    info.appendChild(details);\n    if (asset.tags.length) {\n      const tagLine = document.createElement('span');\n      tagLine.textContent = `tags: ${asset.tags.join(', ')}`;\n      info.appendChild(tagLine);\n    }\n\n    const controls = document.createElement('div');\n    controls.className = 'asset-controls';\n\n    if (asset.kind === 'video') {\n      const player = ensureVideoPlayer(asset);\n      const playButton = document.createElement('button');\n      playButton.textContent = 'Play';\n      playButton.addEventListener('click', () => {\n        if (!player) return;\n        if (player.paused) {\n          player.play();\n          playButton.textContent = 'Pause';\n        } else {\n          player.pause();\n          playButton.textContent = 'Play';\n        }\n      });\n      const loopButton = document.createElement('button');\n      loopButton.textContent = asset.options?.loop ? 'Loop On' : 'Loop Off';\n      loopButton.addEventListener('click', () => {\n        const next = !(asset.options?.loop ?? true);\n        asset.options = { ...asset.options, loop: next };\n        loopButton.textContent = next ? 'Loop On' : 'Loop Off';\n        if (player) player.loop = next;\n      });\n      const speedInput = document.createElement('input');\n      speedInput.type = 'range';\n      speedInput.min = '0.25';\n      speedInput.max = '2';\n      speedInput.step = '0.05';\n      speedInput.value = String(asset.options?.playbackRate ?? 1);\n      speedInput.addEventListener('input', () => {\n        const value = Number(speedInput.value);\n        asset.options = { ...asset.options, playbackRate: value };\n        if (player) player.playbackRate = value;\n      });\n      const reverseButton = document.createElement('button');\n      reverseButton.textContent = asset.options?.reverse ? 'Reverse On' : 'Reverse Off';\n      reverseButton.addEventListener('click', () => {\n        const next = !(asset.options?.reverse ?? false);\n        asset.options = { ...asset.options, reverse: next };\n        reverseButton.textContent = next ? 'Reverse On' : 'Reverse Off';\n      });\n      const blendInput = document.createElement('input');\n      blendInput.type = 'range';\n      blendInput.min = '0';\n      blendInput.max = '1';\n      blendInput.step = '0.05';\n      blendInput.value = String(asset.options?.frameBlend ?? 0);\n      blendInput.addEventListener('input', () => {\n        asset.options = { ...asset.options, frameBlend: Number(blendInput.value) };\n      });\n      controls.appendChild(playButton);\n      controls.appendChild(loopButton);\n      controls.appendChild(speedInput);\n      controls.appendChild(reverseButton);\n      controls.appendChild(blendInput);\n    }\n\n    if (asset.kind === 'live') {\n      const status = document.createElement('span');\n      status.textContent = `Live ${asset.options?.liveSource ?? 'source'}`;\n      const stop = document.createElement('button');\n      stop.textContent = 'Stop';\n      stop.addEventListener('click', () => removeAsset(asset));\n      controls.appendChild(status);\n      controls.appendChild(stop);\n    }\n\n    if (asset.kind === 'text') {\n      const textLabel = document.createElement('span');\n      textLabel.textContent = asset.options?.text ?? 'Text layer';\n      controls.appendChild(textLabel);\n    }\n\n    const removeBtn = document.createElement('button');\n    removeBtn.textContent = '✕';\n    removeBtn.addEventListener('click', () => removeAsset(asset));\n    controls.appendChild(removeBtn);\n\n    row.appendChild(preview);\n    row.appendChild(info);\n    row.appendChild(controls);\n    assetList.appendChild(row);\n  });\n};\n"""
text = text[:start] + new_block + text[end:]
Path('src/renderer/index.ts').write_text(text, encoding='utf-8')
